(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{40186:(e,t,s)=>{"use strict";s.d(t,{Fc:()=>c,TN:()=>o,XL:()=>d});var r=s(58081),a=s(82149),n=s(23484),i=s(87687);let l=(0,n.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=a.forwardRef((e,t)=>{let{className:s,variant:a,...n}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(l({variant:a}),s),...n})});c.displayName="Alert";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",s),...a})});d.displayName="AlertTitle";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",s),...a})});o.displayName="AlertDescription"},54507:(e,t,s)=>{"use strict";s.d(t,{f:()=>a});var r=s(65900);let a={async getBalance(){try{let e=await r.E.get("/credits/balance");if(e.data&&e.data.balance){let t=e.data.balance,s={id:0,user_id:0,total_points:t.total||0,used_points:t.used||0,available_points:t.available||0,expired_points:t.expired||0,is_current_subscription:t.is_current_subscription||!1,free_model_usage_count:t.free_model_usage_count||0,checkin_points:t.checkin_points||0,admin_gift_points:t.admin_gift_points||0,accumulated_tokens:t.accumulated_tokens||0,auto_refill:t.auto_refill||void 0,updated_at:new Date().toISOString()};return{success:!0,data:s}}return{success:!0,data:e.data}}catch(s){var e,t;return console.error("获取积分余额失败:",s),{success:!1,message:(null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"获取积分余额失败"}}},async getUsageHistory(e){try{let t=await r.E.get("/credits/history",{params:e});return{success:!0,data:t.data}}catch(e){var t,s;return console.error("获取积分使用历史失败:",e),{success:!1,message:(null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"获取积分使用历史失败"}}},async getModelCosts(){try{let e=await r.E.get("/credits/model-costs");return{success:!0,data:e.data}}catch(s){var e,t;return console.error("获取模型价格失败:",s),{success:!1,message:(null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"获取模型价格失败"}}},async getPricingTable(){try{let e=await r.E.get("/credits/pricing-table");return{success:!0,data:e.data}}catch(s){var e,t;return console.error("获取计费配置失败:",s),{success:!1,message:(null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"获取计费配置失败"}}}}},62765:(e,t,s)=>{"use strict";s.d(t,{z:()=>a});var r=s(65900);let a={async getPointBalance(){try{let e=await r.E.get("/credits/balance");if(e.data&&e.data.balance){let t=e.data.balance,s={id:0,user_id:0,total_points:t.total||0,used_points:t.used||0,available_points:t.available||0,expired_points:t.expired||0,is_current_subscription:t.is_current_subscription||!1,free_model_usage_count:t.free_model_usage_count||0,checkin_points:t.checkin_points||0,admin_gift_points:t.admin_gift_points||0,updated_at:new Date().toISOString()};return{success:!0,data:s}}return{success:!0,data:e.data}}catch(s){var e,t;return console.error("获取积分余额失败:",s),{success:!1,message:(null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"获取积分余额失败"}}},async getActiveSubscription(){try{let e=await r.E.get("/subscription/active");return{success:!0,data:e.data.subscriptions||[]}}catch(s){var e,t;return console.error("获取订阅信息失败:",s),{success:!1,message:(null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"获取订阅信息失败"}}},async getDashboardData(){try{let[e,t]=await Promise.all([this.getPointBalance(),this.getActiveSubscription()]);return{success:!0,data:{pointBalance:e.success&&e.data||null,subscriptions:t.success&&t.data||[]}}}catch(e){return console.error("获取仪表盘数据失败:",e),{success:!1,message:"获取仪表盘数据失败"}}}}},64317:(e,t,s)=>{"use strict";s.d(t,{k:()=>l});var r=s(58081),a=s(82149),n=s(12023),i=s(87687);let l=a.forwardRef((e,t)=>{let{className:s,value:a,...l}=e;return(0,r.jsx)(n.bL,{ref:t,className:(0,i.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...l,children:(0,r.jsx)(n.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});l.displayName=n.bL.displayName},82347:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>z});var r=s(58081),a=s(82149),n=s(19651),i=s(54271),l=s(86810),c=s(5160),d=s(40186),o=s(59921),u=s(22486),x=s(32184),m=s(63602),h=s(13577),p=s(21100),g=s(5516),f=s(86164),b=s(79708),j=s(34578),v=s(11986),N=s(47950),y=s.n(N);function w(e){return new Promise(t=>setTimeout(t,e))}class k{getTimeout(){return this.index<=this.operation.length?Math.random()*(this.enableCursor?200:100):Math.random()*this.timeout}async count(){this.index+=1,this.cursor=!this.cursor,this.running&&window.typing===this.id&&(this.index<=this.operation.length?(this.setState(this.operation.substring(0,this.index)+(this.enableCursor&&this.cursor?"|":"")),await w(this.getTimeout()),this.animationFrameId=requestAnimationFrame(()=>this.count())):(0===this.offset&&this.finish(!0),this.enableCursor&&this.offset<=12?(this.setState(this.operation+(this.offset%5<=1&&this.cursor?"|":"")),this.offset+=1,await w(this.getTimeout()),this.animationFrameId=requestAnimationFrame(()=>this.count())):this.setState(this.operation)))}finish(e){this.hook&&this.hook(e)}run(){this.animationFrameId=requestAnimationFrame(()=>this.count())}stop(){let e=this.running;return this.running=!1,this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.finish(!1),e}constructor(e,t=800,s=!1,r,a){this.operation=e,this.timeout=t,this.enableCursor=s,this.setState=r,this.cursor=!0,this.index=0,this.running=!0,this.offset=0,this.hook=a,this.animationFrameId=null,this.id=Date.now(),window.typing=this.id}}function _(e){let{userName:t}=e,[s,n]=(0,a.useState)(""),[i,l]=(0,a.useState)(""),[c,d]=(0,a.useState)(""),[o,u]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{n((()=>{let e=new Date().getHours();return e<12?"早上好":e<18?"中午好":"晚上好"})());let e=(e,t)=>{l(""),u(!1),new k(t?"「 ".concat(e," 」 —— ").concat(t):"「 ".concat(e," 」"),800,!0,l).run()};fetch("https://v1.hitokoto.cn/?c=i").then(e=>e.json()).then(t=>{t&&t.hitokoto&&(d(t.hitokoto),e(t.hitokoto,t.from))}).catch(t=>{console.error("Error fetching hitokoto:",t),e("天生我材必有用，千金散尽还复来。","将进酒")})},[]),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-foreground",children:[(0,r.jsx)("span",{role:"img","aria-label":"waving hand",children:"\uD83D\uDC4B"})," ",s,", ",t]}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("p",{className:"text-base text-muted-foreground",children:i})})]})}var S=s(85977),A=s(68308),D=s(34997),B=s(65900);let E={getStatus:async()=>(await B.E.get("/checkin/status")).data,checkin:async()=>(await B.E.post("/checkin")).data};var F=s(6314),R=s(92357);function L(e){let{onCheckinSuccess:t}=e,[s,n]=(0,a.useState)(!1),[i,d]=(0,a.useState)(!0),[o,u]=(0,a.useState)(null),[x,m]=(0,a.useState)(null),h=async()=>{d(!0),m(null);try{let e=await E.getStatus();u(e)}catch(e){console.error("获取签到状态失败:",x),m(x.message||"获取签到状态失败")}finally{d(!1)}};(0,a.useEffect)(()=>{h()},[]);let p=async()=>{if(null==o?void 0:o.canCheckin){n(!0);try{let e=await E.checkin();e.success?(f(),F.oR.success("签到成功! \uD83C\uDF89",{description:"恭喜获得 ".concat(e.rewardPoints," 积分奖励")}),await h(),t&&t()):(0,F.oR)({title:"签到失败",description:e.message,variant:"destructive"})}catch(e){console.error("签到失败:",x),(0,F.oR)({title:"签到失败",description:x.message||"网络错误，请稍后再试",variant:"destructive"})}finally{n(!1)}}},f=()=>{let e=Date.now()+3e3,t={startVelocity:30,spread:360,ticks:60,zIndex:0};function s(e,t){return Math.random()*(t-e)+e}let r=setInterval(function(){let a=e-Date.now();if(a<=0)return clearInterval(r);let n=a/3e3*50;(0,R.A)({...t,particleCount:n,origin:{x:s(.1,.3),y:Math.random()-.2}}),(0,R.A)({...t,particleCount:n,origin:{x:s(.7,.9),y:Math.random()-.2}})},250)};if(i)return(0,r.jsx)(l.Zp,{className:"bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 border-purple-200 dark:border-purple-700",children:(0,r.jsx)(l.Wu,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{className:"text-purple-700 dark:text-purple-300",children:"正在加载签到状态..."})]})})});if(x)return(0,r.jsx)(l.Zp,{className:"bg-gradient-to-br from-red-50 to-orange-50 dark:from-red-900/20 dark:to-orange-900/20 border-red-200 dark:border-red-700",children:(0,r.jsx)(l.Wu,{className:"p-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-red-700 dark:text-red-300 mb-2",children:"签到功能加载失败"}),(0,r.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400 mb-3",children:x}),(0,r.jsx)(c.$,{onClick:h,variant:"outline",size:"sm",className:"border-red-300 text-red-700 hover:bg-red-50",children:"重试"})]})})});if(!o||!o.pointsRange.hasValid)return console.log("没有有效的签到配置:",o),null;let{canCheckin:b,todayChecked:j,lastCheckinDate:v,pointsRange:N}=o;return(0,r.jsxs)(l.Zp,{className:"bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 border-purple-200 dark:border-purple-700",children:[(0,r.jsx)(l.aR,{className:"pb-3",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-purple-100 dark:bg-purple-900 rounded-full",children:(0,r.jsx)(A.A,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(l.ZB,{className:"text-lg text-purple-900 dark:text-purple-100",children:"每日签到"}),(0,r.jsx)(l.BT,{className:"text-purple-600 dark:text-purple-300",children:"每日签到获得积分奖励"})]})]})}),(0,r.jsx)(l.Wu,{className:"pt-0",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white/50 dark:bg-gray-800/50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(D.A,{className:"h-4 w-4 text-yellow-500"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"奖励范围"})]}),(0,r.jsx)(S.E,{variant:"secondary",className:"bg-purple-100 text-purple-800 dark:bg-purple-800 dark:text-purple-200",children:N.minPoints===N.maxPoints?"".concat(N.minPoints," 积分"):"".concat(N.minPoints,"-").concat(N.maxPoints," 积分")})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white/50 dark:bg-gray-800/50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(g.A,{className:"h-4 w-4 text-blue-500"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"签到状态"})]}),(0,r.jsx)(S.E,{variant:j?"default":"outline",children:j?"今日已签到":"今日未签到"})]}),v&&(0,r.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:["最后签到：",v]}),(0,r.jsx)(c.$,{onClick:p,disabled:!b||s,className:"w-full ".concat(b&&!s?"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400"),children:s?(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{children:"签到中..."})]}):j?"今日已签到":(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(A.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"立即签到"})]})})]})})]})}function C(e){let{value:t,duration:s=600,className:n="",refreshTrigger:i}=e,[l,c]=(0,a.useState)(0),[d,o]=(0,a.useState)(!1),u=(0,a.useRef)();return(0,a.useEffect)(()=>{o(!0),c(0);let e=Date.now(),r=()=>{let a=Math.min((Date.now()-e)/s,1);c(Math.floor(t*(1-Math.pow(1-a,4)))),a<1?u.current=requestAnimationFrame(r):(c(t),o(!1))};u.current&&cancelAnimationFrame(u.current);let a=setTimeout(()=>{u.current=requestAnimationFrame(r)},50);return()=>{u.current&&cancelAnimationFrame(u.current),clearTimeout(a)}},[t,s,i]),(0,r.jsx)("span",{className:"".concat(n," ").concat(d?"transition-all duration-200":""),style:{transform:d?"scale(1.05)":"scale(1)",transition:"transform 0.2s ease-out"},children:l.toLocaleString()})}var P=s(64317),T=s(32706),Z=s(62765),I=s(54507);let M={async getActiveAnnouncements(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"zh";try{let t=await B.E.get("/announcements?language=".concat(e,"&active=true"));return{success:!0,data:t.data.announcements}}catch(e){var t,s;return console.error("获取公告失败:",e),{success:!1,message:(null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"获取公告失败"}}}};function z(){var e,t,s,N,w,k,A;let{user:D,login:E}=(0,T.A)(),R=(0,n.useSearchParams)(),z=(0,n.useRouter)(),[W,X]=(0,a.useState)(null),[$,q]=(0,a.useState)(null),[O,U]=(0,a.useState)([]),[V,H]=(0,a.useState)(!0),[G,J]=(0,a.useState)(null),[K,Q]=(0,a.useState)(0);(0,a.useEffect)(()=>{let e=R.get("auth"),t=R.get("token"),s=R.get("message");if("success"===e&&t){localStorage.setItem("auth_token",t),(async()=>{try{localStorage.setItem("auth_token",t);let e=(await B.E.get("/auth/user")).data;if(e.success&&e.user)E(t,e.user),F.oR.success("登录成功",{description:decodeURIComponent(s||"登录成功")});else throw Error("获取用户信息失败")}catch(e){console.error("OAuth登录处理失败:",e),F.oR.error("登录失败",{description:"获取用户信息失败，请重试"}),localStorage.removeItem("auth_token")}})();let e=new URL(window.location.href);e.searchParams.delete("auth"),e.searchParams.delete("token"),e.searchParams.delete("message"),z.replace(e.pathname+(e.search||""))}},[R,z,F.oR,E]);let Y=async()=>{H(!0),J(null);let[e,t,s]=await Promise.all([Z.z.getDashboardData(),I.f.getBalance(),M.getActiveAnnouncements("zh")]);e.success&&e.data?X(e.data):J(e.message||"加载数据失败"),t.success&&t.data&&q(t.data),s.success&&s.data&&U(s.data),H(!1)};(0,a.useEffect)(()=>{D&&Y()},[D]);let ee=async()=>{try{let[e,t]=await Promise.all([Z.z.getDashboardData(),I.f.getBalance()]);e.success&&e.data&&X(e.data),t.success&&t.data&&q(t.data),Q(e=>e+1)}catch(e){console.error("刷新积分数据失败:",e)}},et=(null==W?void 0:W.pointBalance)?Math.min((W.pointBalance.used_points||0)/Math.max(W.pointBalance.total_points||1,1)*100,100):0,es=e=>{let t=new Date,s=e.getTime()-t.getTime();if(s<=0)return"已过期";let r=Math.floor(s/864e5),a=Math.floor(s%864e5/36e5),n=Math.floor(s%36e5/6e4),i=[];return r>0&&i.push("".concat(r,"天")),a>0&&i.push("".concat(a,"小时")),n>0&&i.push("".concat(n,"分钟")),i.length>0?i.join(""):"不足1分钟"},er=(()=>{if(!(null==W?void 0:W.subscriptions)||0===W.subscriptions.length)return{status:"no_subscription",timeRemaining:"",currentSubscription:null,otherSubscriptions:[]};let e=W.subscriptions.filter(e=>"有效"===e.detailedStatus);if(0===e.length)return{status:"no_active",timeRemaining:"",currentSubscription:null,otherSubscriptions:[]};let t=e.find(e=>e.isCurrentUsing)||e[0],s=e.filter(e=>e.id!==t.id),r=new Date(t.currentPeriodEnd),a=new Date,n=Math.ceil((r.getTime()-a.getTime())/864e5),i=es(r);return n<=3?{status:"expiring_soon",timeRemaining:i,currentSubscription:t,otherSubscriptions:s}:{status:"active",timeRemaining:i,currentSubscription:t,otherSubscriptions:s}})();return(0,r.jsx)(i.DashboardLayout,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(_,{userName:(null==D?void 0:D.username)||"尊贵的用户"}),"expiring_soon"===er.status&&(0,r.jsxs)(d.Fc,{variant:"destructive",className:"shadow-lg bg-card text-card-foreground border-yellow-400 dark:border-yellow-600",children:[(0,r.jsx)(o.A,{className:"h-5 w-5 text-yellow-500 dark:text-yellow-400"}),(0,r.jsx)(d.XL,{className:"text-yellow-700 dark:text-yellow-300",children:"订阅即将到期"}),(0,r.jsxs)(d.TN,{className:"text-yellow-700 dark:text-yellow-400",children:["您的订阅将在 ",(0,r.jsx)("strong",{children:er.timeRemaining})," 后到期。请及时"," ",(0,r.jsx)(y(),{href:"/subscription",className:"font-semibold underline hover:text-yellow-600 dark:hover:text-yellow-200",children:"续订"})," ","以免服务中断。"]})]}),"no_active"===er.status&&(0,r.jsxs)(d.Fc,{variant:"destructive",className:"shadow-lg bg-card text-card-foreground border-red-400 dark:border-red-600",children:[(0,r.jsx)(o.A,{className:"h-5 w-5 text-red-500 dark:text-red-400"}),(0,r.jsx)(d.XL,{className:"text-red-700 dark:text-red-300",children:"暂无有效订阅"}),(0,r.jsxs)(d.TN,{className:"text-red-700 dark:text-red-400",children:["您当前没有有效的订阅。请"," ",(0,r.jsx)(y(),{href:"/subscription",className:"font-semibold underline hover:text-red-600 dark:hover:text-red-200",children:"激活订阅"})," ","以享受完整服务。"]})]}),G&&(0,r.jsxs)(d.Fc,{variant:"destructive",children:[(0,r.jsx)(o.A,{className:"h-4 w-4"}),(0,r.jsx)(d.XL,{children:"加载失败"}),(0,r.jsx)(d.TN,{children:G})]}),(0,r.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[(0,r.jsxs)(l.Zp,{className:"shadow-lg bg-card text-card-foreground border-border",children:[(0,r.jsx)(l.aR,{className:"pb-2",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(l.ZB,{className:"text-lg",children:"积分状态"}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)(c.$,{variant:"ghost",size:"sm",onClick:ee,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800",children:(0,r.jsx)(u.A,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"})})})]})}),(0,r.jsx)(l.Wu,{className:"pb-2",children:!V&&(null==W?void 0:W.pointBalance)?(W.pointBalance.total_points||0)>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-end justify-between mb-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:(0,r.jsx)(C,{value:W.pointBalance.available_points||0,duration:800,className:"text-2xl font-bold",refreshTrigger:K})}),(0,r.jsx)("div",{className:"text-xs text-muted-foreground",children:"当前积分"})]}),(0,r.jsxs)(y(),{href:"/credits",className:"text-sm text-sky-500 hover:text-sky-600 dark:text-sky-400 dark:hover:text-sky-300 flex items-center",children:["详情 ",(0,r.jsx)(m.A,{className:"h-4 w-4 ml-1"})]})]}),(0,r.jsxs)("div",{className:"text-xs text-slate-600 dark:text-slate-400 mb-2",children:[(0,r.jsxs)("span",{children:["积分总数: ",(0,r.jsx)("span",{className:"font-semibold text-slate-700 dark:text-slate-300",children:(null===(e=W.pointBalance.total_points)||void 0===e?void 0:e.toLocaleString())||"0"})]}),(0,r.jsx)("span",{className:"mx-2",children:"|"}),(0,r.jsxs)("span",{children:["已使用: ",(0,r.jsx)("span",{className:"font-semibold text-slate-700 dark:text-slate-300",children:(null===(t=W.pointBalance.used_points)||void 0===t?void 0:t.toLocaleString())||"0"})]}),(W.pointBalance.checkin_points||0)>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"mx-2",children:"|"}),(0,r.jsxs)("span",{children:["签到积分: ",(0,r.jsx)("span",{className:"font-semibold text-purple-600 dark:text-purple-400",children:null===(s=W.pointBalance.checkin_points)||void 0===s?void 0:s.toLocaleString()})]})]}),(W.pointBalance.admin_gift_points||0)>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"mx-2",children:"|"}),(0,r.jsxs)("span",{children:["管理员赠送: ",(0,r.jsx)("span",{className:"font-semibold text-amber-600 dark:text-amber-400",children:null===(N=W.pointBalance.admin_gift_points)||void 0===N?void 0:N.toLocaleString()})]})]})]}),(W.pointBalance.total_points||0)>0&&(0,r.jsxs)("div",{className:"relative mb-2",children:[(0,r.jsx)(P.k,{value:et,className:"h-6 [&>*]:bg-sky-500"}),(0,r.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center text-xs font-medium text-white mix-blend-difference",children:[(null===(w=W.pointBalance.available_points)||void 0===w?void 0:w.toLocaleString())||"0"," / ",(null===(k=W.pointBalance.total_points)||void 0===k?void 0:k.toLocaleString())||"0"]})]}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground opacity-75",children:["* 仅显示当前有效订阅数据，使用率: ",et.toFixed(1),"%"]}),(null==$?void 0:null===(A=$.auto_refill)||void 0===A?void 0:A.enabled)&&(0,r.jsxs)("div",{className:"bg-gradient-to-r from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20 rounded-lg p-2.5 border border-emerald-200 dark:border-emerald-800 mt-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(h.A,{className:"h-3.5 w-3.5 text-emerald-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-emerald-800 dark:text-emerald-200",children:"自动补给"}),(0,r.jsx)(S.E,{className:$.auto_refill.needs_refill?"bg-orange-500 text-white":"bg-green-500 text-white",children:$.auto_refill.needs_refill?"待补给":"正常"})]}),(0,r.jsxs)("span",{className:"text-xs text-emerald-700 dark:text-emerald-300 font-mono bg-emerald-100 dark:bg-emerald-900/50 px-2 py-0.5 rounded",children:["当前积分 ≤ ",$.auto_refill.threshold," → 自动补给 +",$.auto_refill.amount]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-1.5 text-xs",children:[(0,r.jsx)("span",{className:"text-emerald-600 dark:text-emerald-400 bg-emerald-100 dark:bg-emerald-900/30 px-2 py-0.5 rounded",children:"\uD83D\uDD50 检查时间: 0、4、8、12、16、20点"}),(0,r.jsx)("span",{className:"text-emerald-600 dark:text-emerald-400 bg-emerald-100 dark:bg-emerald-900/30 px-2 py-0.5 rounded",children:"积分不足时自动触发"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-1.5 text-xs",children:[(0,r.jsx)("div",{className:"flex items-center gap-3",children:$.auto_refill.last_refill_time&&(0,r.jsxs)("span",{className:"text-emerald-600 dark:text-emerald-400 bg-green-100 dark:bg-green-900/30 px-2 py-0.5 rounded",children:["✅ 上次补给: ",new Date($.auto_refill.last_refill_time).toLocaleString("zh-CN",{month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"})]})}),$.auto_refill.needs_refill&&(0,r.jsx)("span",{className:"text-orange-700 dark:text-orange-300 font-medium bg-orange-100 dark:bg-orange-900/30 px-2 py-0.5 rounded",children:"⚠️ 积分不足，等待自动补给"})]})]})]}):(0,r.jsxs)("div",{className:"text-center py-4",children:[(0,r.jsx)("p",{className:"text-lg font-medium text-muted-foreground",children:"暂无积分数据"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"请联系管理员或使用激活码充值"})]}):(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)(x.A,{className:"h-6 w-6 animate-spin"}),(0,r.jsx)("span",{className:"ml-2",children:"加载中..."})]})})]}),(0,r.jsxs)(l.Zp,{className:"shadow-lg bg-card text-card-foreground border-border",children:[(0,r.jsx)(l.aR,{className:"pb-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(l.ZB,{children:"订阅状态"}),(0,r.jsx)(p.A,{className:"h-5 w-5 text-sky-500 dark:text-sky-400"})]})}),(0,r.jsx)(l.Wu,{className:"pb-2",children:V?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)(x.A,{className:"h-6 w-6 animate-spin"}),(0,r.jsx)("span",{className:"ml-2",children:"加载中..."})]}):er.currentSubscription?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xl font-bold text-sky-500 dark:text-sky-400",children:er.currentSubscription.plan.name}),er.currentSubscription.isCurrentUsing&&(0,r.jsx)(S.E,{className:"bg-blue-500 text-white text-xs mt-1",children:"当前消耗"})]}),(0,r.jsx)(S.E,{className:"active"===er.status?"bg-green-500 text-white dark:bg-green-600":"bg-yellow-500 text-white dark:bg-yellow-600",children:"expiring_soon"===er.status?"即将到期":"有效"})]}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground space-y-1",children:[(0,r.jsxs)("p",{className:"flex items-center",children:[(0,r.jsx)(g.A,{className:"h-3 w-3 mr-1 inline"}),"下次账单日期: ",new Date(er.currentSubscription.currentPeriodEnd).toLocaleDateString()]}),(0,r.jsxs)("p",{children:["积分: ",er.currentSubscription.availablePoints.toLocaleString()," / ",er.currentSubscription.totalPoints.toLocaleString()]})]}),er.otherSubscriptions.length>0&&(0,r.jsxs)("div",{className:"mt-3 pt-3 border-t border-border",children:[(0,r.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"其他订阅:"}),(0,r.jsxs)("div",{className:"space-y-1",children:[er.otherSubscriptions.slice(0,2).map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[(0,r.jsx)("span",{children:e.plan.name}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(S.E,{variant:"outline",className:"text-xs",children:e.detailedStatus}),(0,r.jsxs)("span",{className:"text-muted-foreground",children:[e.availablePoints.toLocaleString(),"积分"]})]})]},e.id)),er.otherSubscriptions.length>2&&(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["还有 ",er.otherSubscriptions.length-2," 个订阅..."]})]})]})]}):(0,r.jsxs)("div",{className:"text-center py-4",children:[(0,r.jsx)("p",{className:"text-lg font-medium text-muted-foreground",children:"暂无套餐"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"您可以使用激活码激活套餐"})]})}),(0,r.jsx)(l.wL,{className:"pt-0",children:(0,r.jsx)(c.$,{size:"sm",variant:"outline",className:"w-full text-sky-600 border-sky-200 hover:bg-sky-50 hover:text-sky-700 dark:text-sky-400 dark:border-sky-800/30 dark:hover:bg-sky-900/30",asChild:!0,children:(0,r.jsxs)(y(),{href:"/subscription",children:[(0,r.jsx)(p.A,{className:"mr-2 h-4 w-4"}),er.currentSubscription?"管理订阅":"激活套餐"]})})})]}),(0,r.jsx)(L,{onCheckinSuccess:Y})]}),(0,r.jsxs)(l.Zp,{className:"shadow-lg bg-card text-card-foreground border-border",children:[(0,r.jsx)(l.aR,{children:(0,r.jsx)(l.ZB,{className:"text-2xl",children:"系统公告 \uD83D\uDCE2"})}),(0,r.jsx)(l.Wu,{className:"space-y-4",children:O.length>0?O.map(e=>(0,r.jsxs)(d.Fc,{className:"bg-card text-card-foreground border-border",children:[(0,r.jsx)(f.A,{className:"h-5 w-5 text-sky-500 dark:text-sky-400"}),(0,r.jsxs)(d.XL,{children:[e.title,(0,r.jsx)("span",{className:"text-xs text-muted-foreground ml-2",children:new Date(e.created_at).toLocaleDateString()})]}),(0,r.jsx)(d.TN,{children:(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:e.description}})})]},e.id)):(0,r.jsxs)(d.Fc,{className:"bg-card text-card-foreground border-border",children:[(0,r.jsx)(f.A,{className:"h-5 w-5 text-sky-500 dark:text-sky-400"}),(0,r.jsx)(d.XL,{children:"暂无公告"}),(0,r.jsx)(d.TN,{children:"当前没有系统公告。"})]})})]}),(0,r.jsxs)(l.Zp,{className:"shadow-lg bg-card text-card-foreground border-border",children:[(0,r.jsx)(l.aR,{children:(0,r.jsx)(l.ZB,{className:"text-2xl",children:"快速操作 ⚡️"})}),(0,r.jsxs)(l.Wu,{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,r.jsxs)(l.Zp,{className:"shadow-md bg-card text-card-foreground border-border hover:shadow-lg transition-shadow",children:[(0,r.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(l.ZB,{className:"text-lg font-medium",children:"订阅管理"}),(0,r.jsx)(p.A,{className:"h-6 w-6 text-sky-500 dark:text-sky-400"})]}),(0,r.jsxs)(l.Wu,{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:"查看和管理您的订阅计划、历史记录和优惠券。"}),(0,r.jsx)(c.$,{variant:"outline",size:"sm",asChild:!0,className:"border-border text-foreground hover:bg-accent hover:text-accent-foreground",children:(0,r.jsxs)(y(),{href:"/subscription",children:["前往订阅 ",(0,r.jsx)(b.A,{className:"ml-1 h-4 w-4"})]})})]})]}),(0,r.jsxs)(l.Zp,{className:"shadow-md bg-card text-card-foreground border-border hover:shadow-lg transition-shadow",children:[(0,r.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(l.ZB,{className:"text-lg font-medium",children:"积分中心"}),(0,r.jsx)(j.A,{className:"h-6 w-6 text-green-500 dark:text-green-400"})]}),(0,r.jsxs)(l.Wu,{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:"查看您的积分余额、使用记录和积分历史。"}),(0,r.jsx)(c.$,{variant:"outline",size:"sm",asChild:!0,className:"border-border text-foreground hover:bg-accent hover:text-accent-foreground",children:(0,r.jsxs)(y(),{href:"/credits",children:["查看积分 ",(0,r.jsx)(b.A,{className:"ml-1 h-4 w-4"})]})})]})]}),(0,r.jsxs)(l.Zp,{className:"shadow-md bg-card text-card-foreground border-border hover:shadow-lg transition-shadow",children:[(0,r.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(l.ZB,{className:"text-lg font-medium",children:"资源文档"}),(0,r.jsx)(v.A,{className:"h-6 w-6 text-purple-500 dark:text-purple-400"})]}),(0,r.jsxs)(l.Wu,{children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:"访问我们的帮助文档、API参考和教程。"}),(0,r.jsx)(c.$,{variant:"outline",size:"sm",asChild:!0,className:"border-border text-foreground hover:bg-accent hover:text-accent-foreground",children:(0,r.jsxs)(y(),{href:"/resources",children:["浏览资源 ",(0,r.jsx)(b.A,{className:"ml-1 h-4 w-4"})]})})]})]})]})]})]})})}},85977:(e,t,s)=>{"use strict";s.d(t,{E:()=>l});var r=s(58081);s(82149);var a=s(23484),n=s(87687);let i=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)(i({variant:s}),t),...a})}},89057:(e,t,s)=>{Promise.resolve().then(s.bind(s,82347))}},e=>{var t=t=>e(e.s=t);e.O(0,[590,807,976,191,314,162,316,271,497,954,358],()=>t(89057)),_N_E=e.O()}]);