(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[558],{40186:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>d,TN:()=>o,XL:()=>c});var s=a(58081),r=a(82149),l=a(23484),n=a(87687);let i=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=r.forwardRef((e,t)=>{let{className:a,variant:r,...l}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,n.cn)(i({variant:r}),a),...l})});d.displayName="Alert";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",a),...r})});c.displayName="AlertTitle";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",a),...r})});o.displayName="AlertDescription"},48796:(e,t,a)=>{"use strict";a.d(t,{DeviceManagement:()=>eh});var s=a(58081),r=a(82149),l=a(86810),n=a(5160),i=a(85977),d=a(89181),c=a(40186),o=a(55765),x=a(51018);let u=(0,x.A)("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]),m=(0,x.A)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);var h=a(31511);let g=(0,x.A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var p=a(72235),f=a(59921),v=a(56079);let y=(0,x.A)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),j=(0,x.A)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),b=(0,x.A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var N=a(65900);let w=()=>N.E.get("/devices"),k=()=>N.E.get("/devices/stats"),A=e=>N.E.delete("/devices/".concat(e)),R=()=>N.E.delete("/devices"),D=()=>N.E.delete("/devices/force");var _=a(6314),E=a(59100),M=a(67351),C=a(18112),T=a(35990),S=a(18050),F="AlertDialog",[O,z]=(0,E.A)(F,[C.Hs]),L=(0,C.Hs)(),P=e=>{let{__scopeAlertDialog:t,...a}=e,r=L(t);return(0,s.jsx)(C.bL,{...r,...a,modal:!0})};P.displayName=F;var V=r.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...r}=e,l=L(a);return(0,s.jsx)(C.l9,{...l,...r,ref:t})});V.displayName="AlertDialogTrigger";var Z=e=>{let{__scopeAlertDialog:t,...a}=e,r=L(t);return(0,s.jsx)(C.ZL,{...r,...a})};Z.displayName="AlertDialogPortal";var q=r.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...r}=e,l=L(a);return(0,s.jsx)(C.hJ,{...l,...r,ref:t})});q.displayName="AlertDialogOverlay";var B="AlertDialogContent",[H,$]=O(B),I=(0,S.Dc)("AlertDialogContent"),W=r.forwardRef((e,t)=>{let{__scopeAlertDialog:a,children:l,...n}=e,i=L(a),d=r.useRef(null),c=(0,M.s)(t,d),o=r.useRef(null);return(0,s.jsx)(C.G$,{contentName:B,titleName:G,docsSlug:"alert-dialog",children:(0,s.jsx)(H,{scope:a,cancelRef:o,children:(0,s.jsxs)(C.UC,{role:"alertdialog",...i,...n,ref:c,onOpenAutoFocus:(0,T.m)(n.onOpenAutoFocus,e=>{var t;e.preventDefault(),null===(t=o.current)||void 0===t||t.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,s.jsx)(I,{children:l}),(0,s.jsx)(ee,{contentRef:d})]})})})});W.displayName=B;var G="AlertDialogTitle",Y=r.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...r}=e,l=L(a);return(0,s.jsx)(C.hE,{...l,...r,ref:t})});Y.displayName=G;var J="AlertDialogDescription",U=r.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...r}=e,l=L(a);return(0,s.jsx)(C.VY,{...l,...r,ref:t})});U.displayName=J;var X=r.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...r}=e,l=L(a);return(0,s.jsx)(C.bm,{...l,...r,ref:t})});X.displayName="AlertDialogAction";var K="AlertDialogCancel",Q=r.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...r}=e,{cancelRef:l}=$(K,a),n=L(a),i=(0,M.s)(t,l);return(0,s.jsx)(C.bm,{...n,...r,ref:i})});Q.displayName=K;var ee=e=>{let{contentRef:t}=e,a="`".concat(B,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(B,"` by passing a `").concat(J,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(B,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return r.useEffect(()=>{var e;document.getElementById(null===(e=t.current)||void 0===e?void 0:e.getAttribute("aria-describedby"))||console.warn(a)},[a,t]),null},et=a(87687);let ea=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(q,{className:(0,et.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});ea.displayName=q.displayName;let es=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)(Z,{children:[(0,s.jsx)(ea,{}),(0,s.jsx)(W,{ref:t,className:(0,et.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});es.displayName=W.displayName;let er=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,et.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};er.displayName="AlertDialogHeader";let el=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,et.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};el.displayName="AlertDialogFooter";let en=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(Y,{ref:t,className:(0,et.cn)("text-lg font-semibold",a),...r})});en.displayName=Y.displayName;let ei=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(U,{ref:t,className:(0,et.cn)("text-sm text-muted-foreground",a),...r})});ei.displayName=U.displayName;let ed=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(X,{ref:t,className:(0,et.cn)((0,n.r)(),a),...r})});ed.displayName=X.displayName;let ec=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(Q,{ref:t,className:(0,et.cn)((0,n.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...r})});ec.displayName=Q.displayName;let eo=e=>{switch(e){case"mobile":return(0,s.jsx)(o.A,{className:"h-5 w-5"});case"tablet":return(0,s.jsx)(u,{className:"h-5 w-5"});default:return(0,s.jsx)(m,{className:"h-5 w-5"})}},ex=e=>{switch(e){case"web":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300";case"sso":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300"}},eu=e=>{let t=new Date(e),a=Math.floor((new Date().getTime()-t.getTime())/6e4);return a<1?"刚刚":a<60?"".concat(a,"分钟前"):a<1440?"".concat(Math.floor(a/60),"小时前"):"".concat(Math.floor(a/1440),"天前")},em=e=>{if(!e||"0001-01-01T00:00:00Z"===e||0===new Date(e).getTime())return"永不过期";let t=new Date(e);return t<=new Date?"已过期":t.toLocaleString()};function eh(){let[e,t]=(0,r.useState)([]),[a,o]=(0,r.useState)(null),[x,u]=(0,r.useState)(!0),[m,N]=(0,r.useState)(null),E=async()=>{try{u(!0);let[e,a]=await Promise.all([w(),k()]);e.data&&e.data.success&&t(e.data.data.devices),a.data&&a.data.success&&o(a.data.data)}catch(e){console.error("加载设备数据失败:",e),(0,_.oR)({title:"加载失败",description:"无法加载设备数据，请刷新重试",variant:"destructive"})}finally{u(!1)}};(0,r.useEffect)(()=>{E()},[]);let M=async e=>{try{N(e.id);let t=await A(e.id);if(t.data.success)(0,_.oR)({title:"设备已下线",description:"".concat(e.device_name," 已成功下线")}),e.is_current?setTimeout(()=>{window.location.reload()},1e3):E();else throw Error(t.data.message||"下线失败")}catch(e){console.error("下线设备失败:",e),(0,_.oR)({title:"下线失败",description:e.message||"下线设备失败，请重试",variant:"destructive"})}finally{N(null)}},C=async()=>{try{N("others");let t=await R();if(t.data.success){var e;(0,_.oR)({title:"其他设备已下线",description:"已下线 ".concat((null===(e=t.data.data)||void 0===e?void 0:e.revoked_count)||0," 个设备")}),E()}else throw Error(t.data.message||"下线失败")}catch(e){console.error("下线其他设备失败:",e),(0,_.oR)({title:"下线失败",description:e.message||"下线其他设备失败，请重试",variant:"destructive"})}finally{N(null)}},T=async()=>{try{N("all");let e=await D();if(e.data.success)(0,_.oR)({title:"所有设备已下线",description:"您将需要重新登录"}),window.location.reload();else throw Error(e.data.message||"下线失败")}catch(e){console.error("下线所有设备失败:",e),(0,_.oR)({title:"下线失败",description:e.message||"下线所有设备失败，请重试",variant:"destructive"})}finally{N(null)}};return x?(0,s.jsx)(l.Zp,{children:(0,s.jsxs)(l.aR,{children:[(0,s.jsxs)(l.ZB,{className:"flex items-center gap-2",children:[(0,s.jsx)(h.A,{className:"h-5 w-5"}),"设备管理"]}),(0,s.jsx)(l.BT,{children:"正在加载设备信息..."})]})}):(0,s.jsxs)(l.Zp,{children:[(0,s.jsxs)(l.aR,{children:[(0,s.jsxs)(l.ZB,{className:"flex items-center gap-2",children:[(0,s.jsx)(h.A,{className:"h-5 w-5"}),"设备管理"]}),(0,s.jsx)(l.BT,{children:"管理已登录的设备，保护账户安全"})]}),(0,s.jsxs)(l.Wu,{className:"space-y-6",children:[a&&(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4 max-w-2xl mx-auto",children:[(0,s.jsxs)("div",{className:"text-center p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:a.total}),(0,s.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:"总设备"})]}),(0,s.jsxs)("div",{className:"text-center p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:a.web}),(0,s.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:"Web端"})]}),(0,s.jsxs)("div",{className:"text-center p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:a.sso}),(0,s.jsx)("div",{className:"text-sm text-purple-600 dark:text-purple-400",children:"SSO客户端"})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 justify-center",children:[(0,s.jsxs)(n.$,{variant:"outline",onClick:C,disabled:"others"===m,className:"flex items-center gap-2",children:[(0,s.jsx)(g,{className:"h-4 w-4"}),"下线其他设备"]}),(0,s.jsxs)(P,{children:[(0,s.jsx)(V,{asChild:!0,children:(0,s.jsxs)(n.$,{variant:"destructive",disabled:"all"===m,className:"flex items-center gap-2",children:[(0,s.jsx)(p.A,{className:"h-4 w-4"}),"强制下线所有设备"]})}),(0,s.jsxs)(es,{children:[(0,s.jsxs)(er,{children:[(0,s.jsxs)(en,{className:"flex items-center gap-2",children:[(0,s.jsx)(f.A,{className:"h-5 w-5 text-red-500"}),"确认强制下线"]}),(0,s.jsx)(ei,{children:"此操作将下线所有设备（包括当前设备），您需要重新登录。确定要继续吗？"})]}),(0,s.jsxs)(el,{children:[(0,s.jsx)(ec,{children:"取消"}),(0,s.jsx)(ed,{onClick:T,className:"bg-red-500 hover:bg-red-600",children:"确认下线"})]})]})]}),(0,s.jsxs)(n.$,{variant:"ghost",onClick:E,className:"flex items-center gap-2",children:[(0,s.jsx)(v.A,{className:"h-4 w-4"}),"刷新"]})]}),(0,s.jsx)(d.w,{}),(0,s.jsx)("div",{className:"space-y-4",children:0===e.length?(0,s.jsxs)(c.Fc,{children:[(0,s.jsx)(f.A,{className:"h-4 w-4"}),(0,s.jsx)(c.TN,{children:"暂无已登录的设备"})]}):e.map(e=>(0,s.jsx)("div",{className:"p-4 border rounded-lg ".concat(e.is_current?"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-900/20":"border-border bg-card"),children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"text-muted-foreground mt-1",children:eo(e.device_type)}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("h4",{className:"font-medium",children:e.device_name}),e.is_current&&(0,s.jsx)(i.E,{variant:"outline",className:"text-blue-600 border-blue-200",children:"当前设备"}),(0,s.jsx)(i.E,{className:ex(e.source),children:"web"===e.source?"Web端":"SSO客户端"})]}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(y,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.ip}),e.location&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.location})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(b,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:["最后活跃: ",eu(e.last_active)]})]}),(0,s.jsxs)("div",{className:"text-xs",children:["登录时间: ",new Date(e.created_at).toLocaleString()]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:[(0,s.jsx)(b,{className:"h-3 w-3"}),(0,s.jsxs)("span",{className:"".concat("永不过期"===em(e.expires_at)?"text-green-600 dark:text-green-400 font-medium":"text-muted-foreground"),children:["过期时间: ",em(e.expires_at)]})]})]})]})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)(P,{children:[(0,s.jsx)(V,{asChild:!0,children:(0,s.jsx)(n.$,{variant:"outline",size:"sm",disabled:m===e.id,className:"".concat(e.is_current?"text-orange-600 hover:text-orange-700 hover:bg-orange-50 dark:hover:bg-orange-900/20":"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20"),children:(0,s.jsx)(g,{className:"h-3 w-3"})})}),(0,s.jsxs)(es,{children:[(0,s.jsxs)(er,{children:[(0,s.jsxs)(en,{className:"flex items-center gap-2",children:[(0,s.jsx)(f.A,{className:"h-5 w-5 ".concat(e.is_current?"text-orange-500":"text-red-500")}),e.is_current?"下线当前设备":"确认下线设备"]}),(0,s.jsx)(ei,{children:e.is_current?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-orange-600 dark:text-orange-400 font-medium",children:"⚠️ 警告："}),'您正在下线当前设备 "',e.device_name,'"。执行此操作后，您将立即退出登录并需要重新登录才能继续使用。']}):'确定要下线设备 "'.concat(e.device_name,'" 吗？该设备将需要重新登录。')})]}),(0,s.jsxs)(el,{children:[(0,s.jsx)(ec,{children:"取消"}),(0,s.jsx)(ed,{onClick:()=>M(e),className:"".concat(e.is_current?"bg-orange-500 hover:bg-orange-600":"bg-red-500 hover:bg-red-600"),children:e.is_current?"确认下线并退出":"确认下线"})]})]})]})})]})},e.id))})]})]})}},56079:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(51018).A)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]])},59921:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(51018).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},72235:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(51018).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},85977:(e,t,a)=>{"use strict";a.d(t,{E:()=>i});var s=a(58081);a(82149);var r=a(23484),l=a(87687);let n=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,l.cn)(n({variant:a}),t),...r})}},99534:(e,t,a)=>{Promise.resolve().then(a.bind(a,54271)),Promise.resolve().then(a.bind(a,48796))}},e=>{var t=t=>e(e.s=t);e.O(0,[590,807,976,191,314,316,271,497,954,358],()=>t(99534)),_N_E=e.O()}]);