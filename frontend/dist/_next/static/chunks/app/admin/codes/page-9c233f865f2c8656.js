(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[63],{27226:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>P});var a=t(58081),n=t(82149),l=t(68323),i=t(42332),c=t(8010),r=t(8381),d=t(75283),o=t(67531),u=t(51018);let h=(0,u.A)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);var x=t(21107);let m=(0,u.A)("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);var g=t(12521),p=t(92950),j=t(55058),_=t(60392),v=t(43210),b=t(59921),f=t(54271),y=t(86810),N=t(5160),S=t(80900),w=t(57890),C=t(85977),k=t(58747),A=t(16228),z=t(97004),R=t(3877),E=t(25192),L=t(45904),D=t(6314),$=t(35170),I=t(3133);function P(){var e,s,t,u,P,V,q,K,M,H,O,T,B,F,G,J,U,Q,Z,W,X,Y,ee,es,et,ea,en,el,ei,ec,er;let[ed,eo]=(0,n.useState)([]),[eu,eh]=(0,n.useState)([]),[ex,em]=(0,n.useState)(null),[eg,ep]=(0,n.useState)(!1),[ej,e_]=(0,n.useState)({}),[ev,eb]=(0,n.useState)({}),[ef,ey]=(0,n.useState)({page:1,pageSize:10,total:0,totalPages:0}),[eN,eS]=(0,n.useState)({query:"",type:"batch_number",status:"all"}),ew=(0,n.useRef)(null),eC=(0,n.useRef)(!1),[ek,eA]=(0,n.useState)(!1),[ez,eR]=(0,n.useState)(!1),[eE,eL]=(0,n.useState)(!1),[eD,e$]=(0,n.useState)(!1),[eI,eP]=(0,n.useState)(!1),[eV,eq]=(0,n.useState)(null),[eK,eM]=(0,n.useState)(null),[eH,eO]=(0,n.useState)(""),[eT,eB]=(0,n.useState)([]),[eF,eG]=(0,n.useState)(!1),[eJ,eU]=(0,n.useState)(""),[eQ,eZ]=(0,n.useState)({subscription_plan_id:0,count:1,batch_number:""}),[eW,eX]=(0,n.useState)(null),[eY,e0]=(0,n.useState)({daily_limit:0}),e1=[{id:"select",header:e=>{let{table:s}=e;return(0,a.jsx)(k.S,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:e=>s.toggleAllPageRowsSelected(!!e),"aria-label":"全选"})},cell:e=>{let{row:s}=e;return(0,a.jsx)(k.S,{checked:s.getIsSelected(),onCheckedChange:e=>s.toggleSelected(!!e),"aria-label":"选择行"})},enableSorting:!1,enableHiding:!1},{accessorKey:"code",header:e=>{let{column:s}=e;return(0,a.jsxs)(N.$,{variant:"ghost",onClick:()=>s.toggleSorting("asc"===s.getIsSorted()),children:["激活码",(0,a.jsx)(c.A,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{className:"font-mono text-sm",children:s.getValue("code")})}},{accessorKey:"status",header:"状态",cell:e=>{let{row:s}=e,t=s.original,n=t.status,l="",i="secondary";return"unused"===n?(l="未使用",i="secondary"):"expired"===n?(l="已过期",i="destructive"):"used"===n?0===t.available_points&&t.total_points>0?(l="已用完",i="outline"):(l="已使用",i="default"):"depleted"===n&&(l="已用完",i="outline"),(0,a.jsx)(C.E,{variant:i,children:l})}},{accessorKey:"plan_title",header:e=>{let{column:s}=e;return(0,a.jsxs)(N.$,{variant:"ghost",onClick:()=>s.toggleSorting("asc"===s.getIsSorted()),children:["关联计划",(0,a.jsx)(c.A,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{children:s.getValue("plan_title")})}},{accessorKey:"used_by_username",header:"使用者",cell:e=>{let{row:s}=e,t=s.getValue("used_by_username");return(0,a.jsx)("div",{children:t||"-"})}},{accessorKey:"batch_number",header:e=>{let{column:s}=e;return(0,a.jsxs)(N.$,{variant:"ghost",onClick:()=>s.toggleSorting("asc"===s.getIsSorted()),children:["批次号",(0,a.jsx)(c.A,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{children:s.getValue("batch_number")})}},{accessorKey:"points_info",header:"积分信息",cell:e=>{let{row:s}=e,t=s.original;if("unused"===t.status)return(0,a.jsx)("div",{className:"text-muted-foreground",children:"-"});let n=t.total_points>0?t.used_points/t.total_points*100:0,l=n>80,i=n>50;return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:l?"text-red-600":i?"text-yellow-600":"text-green-600",children:t.used_points.toLocaleString()}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:[" / ",t.total_points.toLocaleString()]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,a.jsx)("div",{className:"h-1.5 rounded-full ".concat(l?"bg-red-500":i?"bg-yellow-500":"bg-green-500"),style:{width:"".concat(Math.min(n,100),"%")}})}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[n.toFixed(1),"% 已使用"]})]})}},{accessorKey:"created_at",header:e=>{let{column:s}=e;return(0,a.jsxs)(N.$,{variant:"ghost",onClick:()=>s.toggleSorting("asc"===s.getIsSorted()),children:["创建时间",(0,a.jsx)(c.A,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:s}=e,t=new Date(s.getValue("created_at"));return(0,a.jsx)("div",{children:t.toLocaleDateString()})}},{id:"actions",enableHiding:!1,cell:e=>{let{row:s}=e,t=s.original;return(0,a.jsxs)(R.rI,{children:[(0,a.jsx)(R.ty,{asChild:!0,children:(0,a.jsxs)(N.$,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,a.jsx)("span",{className:"sr-only",children:"打开菜单"}),(0,a.jsx)(r.A,{className:"h-4 w-4"})]})}),(0,a.jsxs)(R.SQ,{align:"end",children:[(0,a.jsx)(R.lp,{children:"操作"}),(0,a.jsxs)(R._2,{onClick:async()=>{await (0,z.l)(t.code)||alert("无法复制激活码，请手动复制。")},children:[(0,a.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"复制激活码"]}),(0,a.jsx)(R.mB,{}),"used"===t.status&&t.used_by_username&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(R._2,{onClick:()=>st(t),className:"text-orange-600",children:[(0,a.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"预览封禁影响"]}),(0,a.jsxs)(R._2,{onClick:()=>sa(t),className:"text-red-600",children:[(0,a.jsx)(h,{className:"mr-2 h-4 w-4"}),"封禁激活码"]}),(0,a.jsx)(R.mB,{})]}),(0,a.jsxs)(R._2,{onClick:()=>si(t),disabled:"used"!==t.status,children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"编辑每日最大使用量"]}),(0,a.jsx)(R._2,{onClick:()=>ss(t.id),disabled:"used"===t.status,className:"text-red-600",children:"删除激活码"})]})]})}}],e2=[{id:"select",header:e=>{let{table:s}=e;return(0,a.jsx)(k.S,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:e=>s.toggleAllPageRowsSelected(!!e),"aria-label":"全选"})},cell:e=>{let{row:s}=e;return(0,a.jsx)(k.S,{checked:s.getIsSelected(),onCheckedChange:e=>s.toggleSelected(!!e),"aria-label":"选择行"})},enableSorting:!1,enableHiding:!1},{accessorKey:"banned_activation_code",header:e=>{let{column:s}=e;return(0,a.jsxs)(N.$,{variant:"ghost",onClick:()=>s.toggleSorting("asc"===s.getIsSorted()),children:["被封禁激活码",(0,a.jsx)(c.A,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{className:"font-mono text-sm",children:s.getValue("banned_activation_code")})}},{accessorKey:"user",header:"受影响用户",cell:e=>{let{row:s}=e,t=s.original.user;return(0,a.jsx)("div",{children:(null==t?void 0:t.username)||"用户ID: ".concat(s.original.user_id)})}},{accessorKey:"frozen_points",header:"冻结积分",cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{className:"text-red-600 font-medium",children:s.getValue("frozen_points").toLocaleString()})}},{accessorKey:"status",header:"状态",cell:e=>{let{row:s}=e,t=s.getValue("status");return(0,a.jsx)(C.E,{variant:"frozen"===t?"destructive":"secondary",children:"frozen"===t?"已冻结":"已恢复"})}},{accessorKey:"ban_reason",header:"封禁原因",cell:e=>{let{row:s}=e,t=s.getValue("ban_reason");return(0,a.jsx)("div",{className:"max-w-xs truncate",title:t,children:t||"未填写"})}},{accessorKey:"admin_user",header:"操作管理员",cell:e=>{let{row:s}=e,t=s.original.admin_user;return(0,a.jsx)("div",{children:(null==t?void 0:t.username)||"系统"})}},{accessorKey:"created_at",header:e=>{let{column:s}=e;return(0,a.jsxs)(N.$,{variant:"ghost",onClick:()=>s.toggleSorting("asc"===s.getIsSorted()),children:["创建时间",(0,a.jsx)(c.A,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:s}=e,t=new Date(s.getValue("created_at"));return(0,a.jsx)("div",{children:t.toLocaleDateString()})}},{id:"actions",enableHiding:!1,cell:e=>{let{row:s}=e,t=s.original;return(0,a.jsxs)(R.rI,{children:[(0,a.jsx)(R.ty,{asChild:!0,children:(0,a.jsxs)(N.$,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,a.jsx)("span",{className:"sr-only",children:"打开菜单"}),(0,a.jsx)(r.A,{className:"h-4 w-4"})]})}),(0,a.jsxs)(R.SQ,{align:"end",children:[(0,a.jsx)(R.lp,{children:"操作"}),(0,a.jsxs)(R._2,{onClick:async()=>{await (0,z.l)(t.banned_activation_code)||alert("无法复制激活码，请手动复制。")},children:[(0,a.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"复制激活码"]}),(0,a.jsx)(R.mB,{}),"frozen"===t.status&&(0,a.jsxs)(R._2,{onClick:()=>sl(t),className:"text-green-600",children:[(0,a.jsx)(m,{className:"mr-2 h-4 w-4"}),"解禁激活码"]})]})]})}}],e4=eF?e2:e1,e5=eF?eT:ed,e6=(0,l.N4)({data:e5,columns:e4,getCoreRowModel:(0,i.HT)(),onColumnVisibilityChange:e_,onRowSelectionChange:eb,manualPagination:!0,pageCount:ef.totalPages,state:{columnVisibility:ej,rowSelection:ev}}),e7=(0,n.useCallback)(async(e,s,t)=>{ep(!0);let a=null!=e?e:ef.page,n=null!=s?s:ef.pageSize,l=null!=t?t:eN;if("frozen_records"===l.type){eG(!0);let e={page:a,page_size:n,...l.query&&{activation_code:l.query},..."all"!==l.status&&{status:"used"===l.status?"frozen":l.status}},s=await $.E.getFrozenRecords(e);s.success&&s.data?(eB(s.data),eo([]),ey(e=>({...e,total:s.total||0,totalPages:s.total_pages||0,page:a,pageSize:s.page_size||n}))):(eB([]),D.oR.error("加载失败",{description:s.message}))}else{eG(!1);let e={page:a,page_size:n,...l.query&&{[l.type]:l.query},..."all"!==l.status&&{status:l.status}},s=await $.E.getActivationCodes(e);s.success&&s.codes?(eo((Array.isArray(s.codes)?s.codes:[]).map(e=>{var s,t,a,n,l,i;return{id:e.id,code:e.code,status:e.status,plan_title:(null===(s=e.plan)||void 0===s?void 0:s.title)||"未知计划",used_by_username:(null===(t=e.used_by)||void 0===t?void 0:t.username)||null,batch_number:e.batch_number||"",created_at:e.created_at,used_at:e.used_at||null,total_points:(null===(a=e.subscription)||void 0===a?void 0:a.total_points)||(null===(n=e.plan)||void 0===n?void 0:n.point_amount)||0,used_points:(null===(l=e.subscription)||void 0===l?void 0:l.used_points)||0,available_points:(null===(i=e.subscription)||void 0===i?void 0:i.available_points)||0}})),eB([]),ey(e=>({...e,total:s.total||0,totalPages:s.total_pages||0,page:a,pageSize:s.page_size||n}))):(eo([]),D.oR.error("加载失败",{description:s.message}))}ep(!1)},[]),e8=async()=>{let e=await $.E.getSubscriptionPlans();e.success&&e.plans&&eh(Array.isArray(e.plans)?e.plans:[])},e3=async()=>{let e=await (0,I.ug)();e.success&&e.user&&em(e.user)};(0,n.useEffect)(()=>{let e=localStorage.getItem("activationCode_searchType");e&&["batch_number","code","username","frozen_records"].includes(e)&&eS(s=>({...s,type:e}))},[]),(0,n.useEffect)(()=>{e8(),e3()},[]),(0,n.useEffect)(()=>{e7(ef.page,ef.pageSize)},[ef.page,ef.pageSize,e7]),(0,n.useEffect)(()=>{1===ef.page?e7(1,ef.pageSize,eN):ey(e=>({...e,page:1}))},[eN.type,eN.status,ef.pageSize,e7]),(0,n.useEffect)(()=>{if(ew.current&&clearTimeout(ew.current),eC.current||""===eN.query){eC.current=!1,1===ef.page?e7(1,ef.pageSize,eN):ey(e=>({...e,page:1}));return}return ew.current=setTimeout(()=>{1===ef.page?e7(1,ef.pageSize,eN):ey(e=>({...e,page:1}))},500),()=>{ew.current&&clearTimeout(ew.current)}},[eN.query,ef.pageSize,e7]);let e9=()=>{eC.current=!0,ey(e=>({...e,page:1})),e7(1,ef.pageSize,eN)},se=async()=>{if(0===eQ.subscription_plan_id){D.oR.error("请选择订阅计划");return}let e=await $.E.createActivationCodes(eQ);if(e.success){let e=eQ.batch_number;D.oR.success("创建成功",{description:"激活码生成完成"}),eU(e),eR(!0),eA(!1),eZ({subscription_plan_id:0,count:1,batch_number:""}),e7(ef.page,ef.pageSize,eN)}else D.oR.error("创建失败",{description:e.message})},ss=async e=>{if(!confirm("确定要删除此激活码吗？"))return;let s=await $.E.deleteActivationCode(e);s.success?(D.oR.success("删除成功"),e7(ef.page,ef.pageSize,eN)):D.oR.error("删除失败",{description:s.message})},st=async e=>{if(!e.used_by_username){D.oR.error("无法预览",{description:"该激活码未被使用"});return}eM(e),ep(!0);try{let s=await $.E.getUsers({search:e.used_by_username});if(!s.success||!s.users||0===s.users.length){D.oR.error("预览失败",{description:"无法找到对应的用户信息"});return}let t=s.users.find(s=>s.username===e.used_by_username);if(!t){D.oR.error("预览失败",{description:"无法找到对应的用户"});return}let a=await $.E.previewBanActivationCode({user_id:t.id,activation_code:e.code});a.success?(eq(a),e$(!0)):D.oR.error("预览失败",{description:a.message})}catch(e){D.oR.error("预览失败",{description:"获取封禁预览信息时发生错误"})}ep(!1)},sa=e=>{eM(e),eO(""),eP(!0)},sn=async()=>{if(eK){ep(!0);try{let e=await $.E.getUsers({search:eK.used_by_username});if(!e.success||!e.users||0===e.users.length){D.oR.error("封禁失败",{description:"无法找到对应的用户信息"});return}let s=e.users.find(e=>e.username===eK.used_by_username);if(!s){D.oR.error("封禁失败",{description:"无法找到对应的用户"});return}let t=await $.E.banActivationCode({user_id:s.id,activation_code:eK.code,reason:eH});t.success?(D.oR.success("封禁成功",{description:"激活码已被封禁"}),eP(!1),e7(ef.page,ef.pageSize,eN)):D.oR.error("封禁失败",{description:t.message})}catch(e){D.oR.error("封禁失败",{description:"执行封禁操作时发生错误"})}ep(!1)}},sl=async e=>{if(confirm("确定要解禁此激活码吗？"))try{let s=await $.E.unbanActivationCode({user_id:e.user_id,activation_code:e.banned_activation_code});s.success?(D.oR.success("解禁成功",{description:"激活码已被解禁"}),e7(ef.page,ef.pageSize,eN)):D.oR.error("解禁失败",{description:s.message})}catch(e){D.oR.error("解禁失败",{description:"执行解禁操作时发生错误"})}},si=async e=>{eX(e);try{let s=await $.E.getSubscriptionDailyLimit(e.id);s.success&&void 0!==s.daily_limit?e0({daily_limit:s.daily_limit}):e0({daily_limit:0})}catch(e){e0({daily_limit:0})}eL(!0)},sc=async()=>{if(!eW)return;let e=await $.E.updateSubscriptionDailyLimit(eW.id,eY.daily_limit);e.success?(D.oR.success("更新成功",{description:"每日使用量限制已更新"}),eL(!1),e7(ef.page,ef.pageSize,eN)):D.oR.error("更新失败",{description:e.message})},sr=()=>{if(!ex)return"";let e=new Date,s=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),n=String(e.getHours()).padStart(2,"0"),l=String(e.getMinutes()).padStart(2,"0"),i=String(e.getSeconds()).padStart(2,"0");return"".concat(ex.username,"-").concat(s,"-").concat(t,"-").concat(a,"-").concat(n,"-").concat(l,"-").concat(i)},sd=async()=>{try{await (0,z.l)(eJ)?(D.oR.success("复制成功",{description:"批次号已复制到剪贴板"}),eR(!1)):D.oR.error("复制失败",{description:"请手动选择批次号文本进行复制"})}catch(e){D.oR.error("复制失败",{description:"请手动选择批次号文本进行复制"})}};return(0,a.jsx)(f.DashboardLayout,{children:(0,a.jsxs)(y.Zp,{className:"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700",children:[(0,a.jsxs)(y.aR,{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(g.A,{className:"h-6 w-6 text-orange-500"}),(0,a.jsx)(y.ZB,{className:"text-slate-900 dark:text-slate-100",children:"激活码管理"})]}),(0,a.jsx)(y.BT,{className:"text-slate-600 dark:text-slate-400",children:"生成和管理订阅计划的激活码，支持搜索、筛选和导出"})]}),(0,a.jsxs)(y.Wu,{children:[(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between py-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(L.l6,{value:eN.type,onValueChange:e=>{eS(s=>({...s,type:e,query:""})),localStorage.setItem("activationCode_searchType",e)},children:[(0,a.jsx)(L.bq,{className:"w-[140px]",children:(0,a.jsx)(L.yv,{placeholder:"搜索类型"})}),(0,a.jsxs)(L.gC,{children:[(0,a.jsx)(L.eb,{value:"batch_number",children:"批次号"}),(0,a.jsx)(L.eb,{value:"code",children:"激活码"}),(0,a.jsx)(L.eb,{value:"username",children:"用户名"}),(0,a.jsx)(L.eb,{value:"frozen_records",children:"冻结记录"})]})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(p.A,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(S.p,{placeholder:"batch_number"===eN.type?"输入批次号搜索...":"code"===eN.type?"输入激活码搜索...":"username"===eN.type?"输入用户名搜索...":"输入激活码搜索冻结记录...",value:eN.query,onChange:e=>eS({...eN,query:e.target.value}),onKeyPress:e=>{"Enter"===e.key&&(eC.current=!0,e9())},className:"pl-8 max-w-sm"})]}),(0,a.jsxs)(L.l6,{value:eN.status,onValueChange:e=>eS({...eN,status:e}),children:[(0,a.jsx)(L.bq,{className:"w-[120px]",children:(0,a.jsx)(L.yv,{placeholder:"状态筛选"})}),(0,a.jsxs)(L.gC,{children:[(0,a.jsx)(L.eb,{value:"all",children:"全部状态"}),(0,a.jsx)(L.eb,{value:"unused",children:"未使用"}),(0,a.jsx)(L.eb,{value:"used",children:"已使用"}),(0,a.jsx)(L.eb,{value:"depleted",children:"已用完"}),(0,a.jsx)(L.eb,{value:"expired",children:"已过期"})]})]}),(0,a.jsx)(N.$,{variant:"outline",size:"sm",onClick:e9,children:"搜索"}),(0,a.jsx)(N.$,{variant:"outline",size:"sm",onClick:()=>{eC.current=!0,eS({query:"",type:eN.type,status:"all"})},children:"重置"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(N.$,{variant:"outline",size:"sm",onClick:()=>{let e=e6.getSelectedRowModel().rows,s=e.length>0?e.map(e=>e.original):ed,t=new Blob(["\uFEFF"+["激活码,状态,关联计划,使用者,批次号,总积分,已使用积分,剩余积分,创建时间,使用时间",...s.map(e=>{let s="";return"unused"===e.status?s="未使用":"expired"===e.status?s="已过期":"used"===e.status?s=0===e.available_points&&e.total_points>0?"已用完":"已使用":"depleted"===e.status&&(s="已用完"),['"'.concat(e.code,'"'),s,'"'.concat(e.plan_title,'"'),'"'.concat(e.used_by_username||"-",'"'),'"'.concat(e.batch_number,'"'),e.total_points||"-",e.used_points||"-",e.available_points||"-",'"'.concat(new Date(e.created_at).toLocaleString(),'"'),'"'.concat(e.used_at?new Date(e.used_at).toLocaleString():"-",'"')].join(",")})].join("\n")],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(t),a.download=eN.batch_number?"activation_codes_".concat(eN.batch_number,"_").concat(new Date().toISOString().split("T")[0],".csv"):"activation_codes_".concat(new Date().toISOString().split("T")[0],".csv"),a.click(),D.oR.success("导出成功",{description:"已导出 ".concat(s.length," 条记录").concat(e.length>0?" (仅选中项)":"")})},disabled:eg,children:[(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"导出CSV"]}),(0,a.jsxs)(R.rI,{children:[(0,a.jsx)(R.ty,{asChild:!0,children:(0,a.jsxs)(N.$,{variant:"outline",className:"ml-auto",children:["列显示 ",(0,a.jsx)(_.A,{className:"ml-2 h-4 w-4"})]})}),(0,a.jsx)(R.SQ,{align:"end",children:e6.getAllColumns().filter(e=>e.getCanHide()).map(e=>(0,a.jsx)(R.hO,{className:"capitalize",checked:e.getIsVisible(),onCheckedChange:s=>e.toggleVisibility(!!s),children:eF?"banned_activation_code"===e.id?"被封禁激活码":"user"===e.id?"受影响用户":"frozen_points"===e.id?"冻结积分":"status"===e.id?"状态":"ban_reason"===e.id?"封禁原因":"admin_user"===e.id?"操作管理员":"created_at"===e.id?"创建时间":e.id:"code"===e.id?"激活码":"status"===e.id?"状态":"plan_title"===e.id?"关联计划":"used_by_username"===e.id?"使用者":"batch_number"===e.id?"批次号":"points_info"===e.id?"积分信息":"created_at"===e.id?"创建时间":e.id},e.id))})]}),(0,a.jsxs)(N.$,{onClick:()=>{eZ({subscription_plan_id:0,count:1,batch_number:sr()}),eA(!0)},className:"bg-orange-500 hover:bg-orange-600 text-white",children:[(0,a.jsx)(v.A,{className:"w-4 h-4 mr-2"}),"生成激活码"]})]})]}),(eN.query||"all"!==eN.status)&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 pb-4",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"当前筛选:"}),eN.query&&(0,a.jsxs)(C.E,{variant:"secondary",children:["batch_number"===eN.type?"批次号":"code"===eN.type?"激活码":"用户名",": ",eN.query]}),"all"!==eN.status&&(0,a.jsxs)(C.E,{variant:"secondary",children:["状态: ","used"===eN.status?"已使用":"unused"===eN.status?"未使用":"depleted"===eN.status?"已用完":"已过期"]})]}),(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(A.XI,{children:[(0,a.jsx)(A.A0,{children:e6.getHeaderGroups().map(e=>(0,a.jsx)(A.Hj,{children:e.headers.map(e=>(0,a.jsx)(A.nd,{children:e.isPlaceholder?null:(0,l.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,a.jsx)(A.BF,{children:eg?(0,a.jsx)(A.Hj,{children:(0,a.jsx)(A.nA,{colSpan:e1.length,className:"h-24 text-center",children:"加载中..."})}):(null===(e=e6.getRowModel().rows)||void 0===e?void 0:e.length)?e6.getRowModel().rows.map(e=>(0,a.jsx)(A.Hj,{"data-state":e.getIsSelected()&&"selected",children:e.getVisibleCells().map(e=>(0,a.jsx)(A.nA,{children:(0,l.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,a.jsx)(A.Hj,{children:(0,a.jsx)(A.nA,{colSpan:e1.length,className:"h-24 text-center",children:"暂无数据"})})})]})}),(0,a.jsxs)("div",{className:"flex items-center justify-between space-x-2 py-4",children:[(0,a.jsxs)("div",{className:"flex-1 text-sm text-muted-foreground",children:[e6.getSelectedRowModel().rows.length," / ",e5.length," 行已选择",(0,a.jsxs)("span",{className:"ml-4",children:["共 ",ef.total," 条记录"]}),eF&&(0,a.jsx)("span",{className:"ml-2 text-orange-600",children:"（冻结记录）"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-6 lg:space-x-8",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"每页显示"}),(0,a.jsxs)(L.l6,{value:"".concat(ef.pageSize),onValueChange:e=>{ey(s=>({...s,pageSize:Number(e),page:1}))},children:[(0,a.jsx)(L.bq,{className:"h-8 w-[70px]",children:(0,a.jsx)(L.yv,{placeholder:ef.pageSize})}),(0,a.jsx)(L.gC,{side:"top",children:[10,20,30,40,50].map(e=>(0,a.jsx)(L.eb,{value:"".concat(e),children:e},e))})]})]}),(0,a.jsxs)("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["第 ",ef.page," 页 / 共 ",ef.totalPages," 页"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(N.$,{variant:"outline",size:"sm",onClick:()=>ey(e=>({...e,page:1})),disabled:ef.page<=1,children:"首页"}),(0,a.jsx)(N.$,{variant:"outline",size:"sm",onClick:()=>ey(e=>({...e,page:e.page-1})),disabled:ef.page<=1,children:"上一页"}),(0,a.jsx)(N.$,{variant:"outline",size:"sm",onClick:()=>ey(e=>({...e,page:e.page+1})),disabled:ef.page>=ef.totalPages,children:"下一页"}),(0,a.jsx)(N.$,{variant:"outline",size:"sm",onClick:()=>ey(e=>({...e,page:ef.totalPages})),disabled:ef.page>=ef.totalPages,children:"尾页"})]})]})]})]}),(0,a.jsx)(E.lG,{open:ek,onOpenChange:eA,children:(0,a.jsxs)(E.Cf,{children:[(0,a.jsxs)(E.c7,{children:[(0,a.jsx)(E.L3,{children:"生成激活码"}),(0,a.jsx)(E.rr,{children:"为指定订阅计划批量生成激活码"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w.J,{children:"订阅计划"}),(0,a.jsxs)(L.l6,{value:eQ.subscription_plan_id.toString(),onValueChange:e=>eZ({...eQ,subscription_plan_id:parseInt(e)}),children:[(0,a.jsx)(L.bq,{children:(0,a.jsx)(L.yv,{placeholder:"选择订阅计划"})}),(0,a.jsx)(L.gC,{children:Array.isArray(eu)&&eu.map(e=>(0,a.jsxs)(L.eb,{value:e.id.toString(),children:[e.title," (",e.point_amount.toLocaleString()," 积分, ",e.validity_days,"天)"]},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w.J,{children:"生成数量"}),(0,a.jsx)(S.p,{type:"number",min:"1",max:"100",value:eQ.count,onChange:e=>eZ({...eQ,count:parseInt(e.target.value)||1})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w.J,{children:"批次号 (可选)"}),(0,a.jsx)(S.p,{value:eQ.batch_number,onChange:e=>eZ({...eQ,batch_number:e.target.value}),placeholder:"例如: BATCH-2024-001"})]})]}),(0,a.jsxs)(E.Es,{children:[(0,a.jsx)(N.$,{variant:"outline",onClick:()=>eA(!1),children:"取消"}),(0,a.jsx)(N.$,{onClick:se,children:"生成"})]})]})}),(0,a.jsx)(E.lG,{open:ez,onOpenChange:eR,children:(0,a.jsxs)(E.Cf,{children:[(0,a.jsxs)(E.c7,{children:[(0,a.jsx)(E.L3,{children:"激活码生成成功"}),(0,a.jsx)(E.rr,{children:"请复制以下批次号用于管理激活码"})]}),(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w.J,{children:"批次号"}),(0,a.jsx)("div",{className:"bg-muted p-3 rounded text-sm font-mono break-all select-all border",children:eJ}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"点击上方文本可选中，或点击下方按钮自动复制"})]})}),(0,a.jsxs)(E.Es,{children:[(0,a.jsx)(N.$,{variant:"outline",onClick:()=>eR(!1),children:"稍后复制"}),(0,a.jsxs)(N.$,{onClick:sd,children:[(0,a.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"复制批次号"]})]})]})}),(0,a.jsx)(E.lG,{open:eE,onOpenChange:eL,children:(0,a.jsxs)(E.Cf,{children:[(0,a.jsxs)(E.c7,{children:[(0,a.jsx)(E.L3,{children:"编辑每日最大使用量"}),(0,a.jsxs)(E.rr,{children:['为激活码 "',null==eW?void 0:eW.code,'" 对应的订阅设置每日最大积分使用量']})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w.J,{children:"每日最大使用量 (积分)"}),(0,a.jsx)(S.p,{type:"number",min:"0",value:eY.daily_limit,onChange:e=>e0({...eY,daily_limit:parseInt(e.target.value)||0}),placeholder:"0表示无限制"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"设置为0表示无限制，大于0的数值表示每日最大积分使用量"})]}),(0,a.jsxs)("div",{className:"bg-muted p-3 rounded text-sm",children:[(0,a.jsx)("p",{className:"font-medium mb-1",children:"激活码信息："}),(0,a.jsxs)("p",{children:["激活码: ",null==eW?void 0:eW.code]}),(0,a.jsxs)("p",{children:["关联计划: ",null==eW?void 0:eW.plan_title]}),(0,a.jsxs)("p",{children:["使用者: ",(null==eW?void 0:eW.used_by_username)||"未使用"]})]})]}),(0,a.jsxs)(E.Es,{children:[(0,a.jsx)(N.$,{variant:"outline",onClick:()=>eL(!1),children:"取消"}),(0,a.jsx)(N.$,{onClick:sc,children:"保存"})]})]})}),(0,a.jsx)(E.lG,{open:eD,onOpenChange:e$,children:(0,a.jsxs)(E.Cf,{className:"max-w-2xl",children:[(0,a.jsxs)(E.c7,{children:[(0,a.jsxs)(E.L3,{className:"flex items-center gap-2",children:[(0,a.jsx)(o.A,{className:"h-5 w-5 text-orange-500"}),"封禁影响预览"]}),(0,a.jsxs)(E.rr,{children:['预览封禁激活码 "',null==eK?void 0:eK.code,'" 对用户的影响']})]}),eV&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"当前用户钱包状态"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"总积分："}),(0,a.jsx)("span",{className:"font-medium",children:(null===(t=eV.current_wallet)||void 0===t?void 0:null===(s=t.total_points)||void 0===s?void 0:s.toLocaleString())||0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"可用积分："}),(0,a.jsx)("span",{className:"font-medium text-green-600",children:(null===(P=eV.current_wallet)||void 0===P?void 0:null===(u=P.available_points)||void 0===u?void 0:u.toLocaleString())||0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"已用积分："}),(0,a.jsx)("span",{className:"font-medium text-orange-600",children:(null===(q=eV.current_wallet)||void 0===q?void 0:null===(V=q.used_points)||void 0===V?void 0:V.toLocaleString())||0})]})]})]}),(0,a.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-red-900 mb-2",children:"封禁后影响"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"将冻结积分："}),(0,a.jsx)("span",{className:"font-medium text-red-600",children:(null===(M=eV.ban_impact)||void 0===M?void 0:null===(K=M.frozen_points)||void 0===K?void 0:K.toLocaleString())||0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"已消费积分："}),(0,a.jsx)("span",{className:"font-medium",children:(null===(O=eV.ban_impact)||void 0===O?void 0:null===(H=O.consumed_points)||void 0===H?void 0:H.toLocaleString())||0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"封禁后总积分："}),(0,a.jsx)("span",{className:"font-medium",children:(null===(B=eV.ban_impact)||void 0===B?void 0:null===(T=B.new_total_points)||void 0===T?void 0:T.toLocaleString())||0})]})]})]}),eV.target_card&&(0,a.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-yellow-900 mb-2",children:"目标激活码信息"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"激活码："}),(0,a.jsx)("span",{className:"font-mono font-medium",children:eV.target_card.code})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"原始积分："}),(0,a.jsx)("span",{className:"font-medium",children:(null===(F=eV.target_card.original_points)||void 0===F?void 0:F.toLocaleString())||0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"剩余积分："}),(0,a.jsx)("span",{className:"font-medium text-green-600",children:(null===(G=eV.target_card.remaining_points)||void 0===G?void 0:G.toLocaleString())||0})]})]})]}),eV.consumption_details&&eV.consumption_details.length>0&&(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"虚拟消费计算详情"}),(0,a.jsx)("div",{className:"max-h-32 overflow-y-auto space-y-2",children:eV.consumption_details.map((e,s)=>(0,a.jsxs)("div",{className:"flex justify-between items-center text-xs bg-white p-2 rounded",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"font-mono text-sm",children:e.card_code}),(0,a.jsxs)("span",{className:"text-gray-500 text-xs",children:["原始: ",e.original_points.toLocaleString(),"积分"]})]}),(0,a.jsx)("div",{className:"text-right",children:"fully_consumed"===e.status?(0,a.jsx)("span",{className:"text-red-600 font-medium",children:"已全部消费"}):e.consumed_points>0?(0,a.jsxs)("div",{className:"text-orange-600",children:[(0,a.jsxs)("div",{children:["消费: ",e.consumed_points.toLocaleString()]}),(0,a.jsxs)("div",{className:"text-green-600",children:["剩余: ",e.remaining_points.toLocaleString()]})]}):(0,a.jsxs)("span",{className:"text-green-600",children:["剩余: ",e.remaining_points.toLocaleString()]})})]},s))})]}),eV.benefits_change&&(0,a.jsxs)("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200 mt-4",children:[(0,a.jsx)("h4",{className:"font-medium text-orange-900 mb-3",children:"⚖️ 权益变化预览"}),eV.benefits_change.will_reset_to_initial&&(0,a.jsxs)("div",{className:"bg-red-100 p-3 rounded-lg border border-red-300 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-800 mb-2",children:[(0,a.jsx)("span",{className:"text-lg",children:"⚠️"}),(0,a.jsx)("span",{className:"font-medium",children:"重要警告"})]}),(0,a.jsx)("p",{className:"text-red-700 text-sm font-medium",children:"封禁此激活码后，用户将没有任何有效的激活码，所有权益将重置为初始状态（即钱包过期状态）！"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border overflow-hidden",children:[(0,a.jsx)("div",{className:"px-4 py-3 bg-blue-50 border-b border-blue-200",children:(0,a.jsx)("h5",{className:"font-semibold text-blue-800 text-sm",children:"权益对比详情"})}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,a.jsx)("div",{className:"font-medium text-gray-600",children:"权益项目"}),(0,a.jsx)("div",{className:"font-medium text-green-600 text-center",children:"当前状态"}),(0,a.jsx)("div",{className:"font-medium text-blue-600 text-center",children:"封禁后状态"}),(0,a.jsx)("div",{className:"col-span-3 border-t border-gray-200 my-2"}),(0,a.jsx)("div",{className:"text-gray-700",children:"\uD83D\uDCCA 每日限额"}),(0,a.jsx)("div",{className:"text-center text-green-600 font-medium",children:(null===(U=eV.benefits_change)||void 0===U?void 0:null===(J=U.current_benefits)||void 0===J?void 0:J.daily_max_points)>0?"".concat(eV.benefits_change.current_benefits.daily_max_points.toLocaleString(),"积分"):"无限制"}),(0,a.jsx)("div",{className:"text-center font-medium",children:(null===(Z=eV.benefits_change)||void 0===Z?void 0:null===(Q=Z.new_benefits)||void 0===Q?void 0:Q.daily_max_points)>0?"".concat(eV.benefits_change.new_benefits.daily_max_points.toLocaleString(),"积分"):(0,a.jsx)("span",{className:"text-red-600",children:"无限制"})}),(0,a.jsx)("div",{className:"text-gray-700",children:"\uD83C\uDF81 签到奖励"}),(0,a.jsx)("div",{className:"text-center text-green-600 font-medium",children:(null===(X=eV.benefits_change)||void 0===X?void 0:null===(W=X.current_benefits)||void 0===W?void 0:W.daily_checkin_points)>0?eV.benefits_change.current_benefits.daily_checkin_points===eV.benefits_change.current_benefits.daily_checkin_points_max?"".concat(eV.benefits_change.current_benefits.daily_checkin_points,"积分"):"".concat(eV.benefits_change.current_benefits.daily_checkin_points,"-").concat(eV.benefits_change.current_benefits.daily_checkin_points_max,"积分"):"未配置"}),(0,a.jsx)("div",{className:"text-center font-medium",children:(null===(ee=eV.benefits_change)||void 0===ee?void 0:null===(Y=ee.new_benefits)||void 0===Y?void 0:Y.daily_checkin_points)>0?eV.benefits_change.new_benefits.daily_checkin_points===eV.benefits_change.new_benefits.daily_checkin_points_max?"".concat(eV.benefits_change.new_benefits.daily_checkin_points,"积分"):"".concat(eV.benefits_change.new_benefits.daily_checkin_points,"-").concat(eV.benefits_change.new_benefits.daily_checkin_points_max,"积分"):(0,a.jsx)("span",{className:"text-red-600",children:"未配置"})}),(0,a.jsx)("div",{className:"text-gray-700",children:"\uD83D\uDD04 自动补给"}),(0,a.jsx)("div",{className:"text-center text-green-600 font-medium",children:(null===(et=eV.benefits_change)||void 0===et?void 0:null===(es=et.current_benefits)||void 0===es?void 0:es.auto_refill_enabled)?"".concat(eV.benefits_change.current_benefits.auto_refill_amount,"积分"):"未启用"}),(0,a.jsx)("div",{className:"text-center font-medium",children:(null===(en=eV.benefits_change)||void 0===en?void 0:null===(ea=en.new_benefits)||void 0===ea?void 0:ea.auto_refill_enabled)?"".concat(eV.benefits_change.new_benefits.auto_refill_amount,"积分"):(0,a.jsx)("span",{className:"text-red-600",children:"未启用"})}),(0,a.jsx)("div",{className:"text-gray-700",children:"\uD83D\uDEE1️ 降智保护"}),(0,a.jsx)("div",{className:"text-center text-green-600 font-medium",children:(null===(ei=eV.benefits_change)||void 0===ei?void 0:null===(el=ei.current_benefits)||void 0===el?void 0:el.degradation_guaranteed)>0?"等级 ".concat(eV.benefits_change.current_benefits.degradation_guaranteed):"无保护"}),(0,a.jsx)("div",{className:"text-center font-medium",children:(null===(er=eV.benefits_change)||void 0===er?void 0:null===(ec=er.new_benefits)||void 0===ec?void 0:ec.degradation_guaranteed)>0?"等级 ".concat(eV.benefits_change.new_benefits.degradation_guaranteed):(0,a.jsx)("span",{className:"text-red-600",children:"无保护"})})]})})]}),(0,a.jsxs)("div",{className:"mt-3 text-xs text-blue-700 bg-blue-100 p-2 rounded",children:[(0,a.jsx)("p",{className:"font-medium mb-1",children:"权益计算说明："}),(0,a.jsxs)("ul",{className:"space-y-1 ml-2",children:[eV.benefits_change.has_remaining_cards?(0,a.jsx)("li",{children:"• 系统将基于剩余有效激活码重新计算最优权益配置"}):(0,a.jsx)("li",{children:"• 封禁后用户将没有任何有效激活码，权益将重置为初始状态"}),(0,a.jsx)("li",{children:"• 权益变化在封禁操作执行后立即生效"})]})]})]})]}),(0,a.jsxs)(E.Es,{children:[(0,a.jsx)(N.$,{variant:"outline",onClick:()=>e$(!1),children:"关闭预览"}),(0,a.jsxs)(N.$,{onClick:()=>{e$(!1),eK&&eP(!0)},className:"bg-red-600 hover:bg-red-700 text-white",children:[(0,a.jsx)(h,{className:"mr-2 h-4 w-4"}),"继续封禁"]})]})]})}),(0,a.jsx)(E.lG,{open:eI,onOpenChange:eP,children:(0,a.jsxs)(E.Cf,{children:[(0,a.jsxs)(E.c7,{children:[(0,a.jsxs)(E.L3,{className:"flex items-center gap-2 text-red-600",children:[(0,a.jsx)(b.A,{className:"h-5 w-5"}),"确认封禁激活码"]}),(0,a.jsxs)(E.rr,{children:['此操作将封禁激活码 "',null==eK?void 0:eK.code,'" 并冻结相应的积分，操作不可撤销。']})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-800 mb-2",children:[(0,a.jsx)(b.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-medium",children:"警告"})]}),(0,a.jsx)("p",{className:"text-red-700 text-sm",children:"封禁操作将："}),(0,a.jsxs)("ul",{className:"text-red-700 text-sm mt-1 ml-4 list-disc",children:[(0,a.jsx)("li",{children:"立即冻结该激活码对应的剩余积分"}),(0,a.jsx)("li",{children:"降级用户的相关权益"}),(0,a.jsx)("li",{children:"创建不可逆的冻结记录"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w.J,{children:"封禁原因 (可选)"}),(0,a.jsx)(S.p,{value:eH,onChange:e=>eO(e.target.value),placeholder:"请输入封禁原因...",maxLength:200}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"封禁原因将被记录在冻结记录中"})]}),eK&&(0,a.jsxs)("div",{className:"bg-muted p-3 rounded text-sm",children:[(0,a.jsx)("p",{className:"font-medium mb-1",children:"即将封禁的激活码："}),(0,a.jsxs)("p",{children:["激活码: ",(0,a.jsx)("span",{className:"font-mono",children:eK.code})]}),(0,a.jsxs)("p",{children:["使用者: ",eK.used_by_username]}),(0,a.jsxs)("p",{children:["关联计划: ",eK.plan_title]})]})]}),(0,a.jsxs)(E.Es,{children:[(0,a.jsx)(N.$,{variant:"outline",onClick:()=>eP(!1),children:"取消"}),(0,a.jsx)(N.$,{onClick:sn,className:"bg-red-600 hover:bg-red-700 text-white",disabled:eg,children:eg?"封禁中...":"确认封禁"})]})]})})]})]})})}},28214:(e,s,t)=>{Promise.resolve().then(t.bind(t,27226))},43210:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(51018).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},59921:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(51018).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},67531:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(51018).A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},75283:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(51018).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[590,807,976,191,314,737,953,370,316,271,608,105,497,954,358],()=>s(28214)),_N_E=e.O()}]);